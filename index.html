<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="theme-color" content="#1976d2" />
    <meta name="description" content="نظام إدارة نقاط البيع SaaS - نظام متكامل للمبيعات والمخزون" />
    <meta name="keywords" content="POS, نقطة بيع, مبيعات, مخزون, فواتير, خزينة" />
    <meta name="author" content="SaaS POS System" />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://yourdomain.com/" />
    <meta property="og:title" content="نظام إدارة نقاط البيع SaaS" />
    <meta property="og:description" content="نظام متكامل لإدارة المبيعات والمخزون والفواتير" />
    <meta property="og:image" content="%PUBLIC_URL%/og-image.png" />
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="https://yourdomain.com/" />
    <meta property="twitter:title" content="نظام إدارة نقاط البيع SaaS" />
    <meta property="twitter:description" content="نظام متكامل لإدارة المبيعات والمخزون والفواتير" />
    <meta property="twitter:image" content="%PUBLIC_URL%/og-image.png" />
    
    <!-- Manifest -->
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet" />
    
    <!-- iOS Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="POS System" />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
    
    <!-- Android Chrome Meta Tags -->
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="application-name" content="POS System" />
    
    <!-- Microsoft Meta Tags -->
    <meta name="msapplication-TileColor" content="#1976d2" />
    <meta name="msapplication-TileImage" content="%PUBLIC_URL%/logo144.png" />
    <meta name="msapplication-config" content="%PUBLIC_URL%/browserconfig.xml" />
    
    <!-- PWA Theme Color -->
    <meta name="theme-color" content="#1976d2" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    
    <!-- App Title -->
    <title>نظام إدارة نقاط البيع | SaaS POS</title>
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "نظام إدارة نقاط البيع SaaS",
        "description": "نظام متكامل لإدارة المبيعات والمخزون والفواتير والخزينة",
        "applicationCategory": "BusinessApplication",
        "operatingSystem": "Web",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        }
    }
    </script>
    
    <!-- Analytics Script (Optional) -->
    <!--
    <script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'GA_MEASUREMENT_ID');
    </script>
    -->
    
    <!-- Firebase SDK (Loaded in firebase.js) -->
    
    <!-- Initial Styles -->
    <style>
        /* Critical CSS for initial loading */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
        }
        
        body {
            margin: 0;
            font-family: 'Cairo', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            direction: rtl;
            text-align: right;
            overflow-x: hidden;
            background-color: #f5f5f5;
        }
        
        /* Loading Screen */
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1976d2 0%, #0d47a1 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease-out;
        }
        
        .loading-logo {
            width: 120px;
            height: 120px;
            margin-bottom: 30px;
            animation: pulse 2s infinite;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        .loading-text {
            color: white;
            font-size: 1.2rem;
            font-weight: 500;
            text-align: center;
        }
        
        .loading-subtext {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
            margin-top: 10px;
            text-align: center;
        }
        
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
        
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.05);
                opacity: 0.8;
            }
        }
        
        /* Hide app until loaded */
        #root {
            opacity: 0;
            transition: opacity 0.3s ease-in;
        }
        
        #root.loaded {
            opacity: 1;
        }
        
        /* Print styles */
        @media print {
            body * {
                visibility: hidden;
            }
            .print-area, .print-area * {
                visibility: visible;
            }
            .print-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
        }
        
        /* Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        /* Focus styles for accessibility */
        :focus {
            outline: 3px solid #1976d2;
            outline-offset: 2px;
        }
        
        :focus:not(:focus-visible) {
            outline: none;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 5px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 5px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        /* Selection color */
        ::selection {
            background-color: #1976d2;
            color: white;
        }
        
        /* Utility classes */
        .text-center {
            text-align: center;
        }
        
        .text-right {
            text-align: right;
        }
        
        .text-left {
            text-align: left;
        }
        
        .full-width {
            width: 100%;
        }
        
        /* RTL specific adjustments */
        .rtl-grid {
            display: grid;
            grid-auto-flow: dense;
        }
        
        /* Responsive images */
        img {
            max-width: 100%;
            height: auto;
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen">
        <div class="loading-logo">
            <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <circle cx="50" cy="50" r="45" fill="none" stroke="white" stroke-width="3"/>
                <path d="M30,30 L70,70 M70,30 L30,70" stroke="white" stroke-width="3" stroke-linecap="round"/>
                <circle cx="50" cy="50" r="15" fill="white" opacity="0.2"/>
            </svg>
        </div>
        <div class="loading-spinner"></div>
        <div class="loading-text">جاري تحميل النظام...</div>
        <div class="loading-subtext">نظام إدارة نقاط البيع SaaS</div>
    </div>
    
    <!-- Skip to main content for accessibility -->
    <a href="#main-content" class="sr-only">تخطي إلى المحتوى الرئيسي</a>
    
    <!-- No Script Warning -->
    <noscript>
        <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 10000; display: flex; justify-content: center; align-items: center; padding: 20px;">
            <div style="max-width: 600px; text-align: center; padding: 40px; border: 2px solid #f44336; border-radius: 10px; background: #fff; box-shadow: 0 4px 20px rgba(0,0,0,0.1);">
                <h1 style="color: #f44336; margin-bottom: 20px;">⚠️ JavaScript مطلوب</h1>
                <p style="font-size: 1.2rem; margin-bottom: 20px; color: #333;">
                    يحتاج هذا التطبيق إلى تفعيل JavaScript للعمل بشكل صحيح.
                    يرجى تمكين JavaScript في متصفحك ثم إعادة تحميل الصفحة.
                </p>
                <p style="color: #666; margin-bottom: 30px;">
                    نظام إدارة نقاط البيع SaaS هو تطبيق ويب تفاعلي يتطلب JavaScript لتوفير جميع الميزات المتقدمة.
                </p>
                <div style="display: flex; justify-content: center; gap: 20px; flex-wrap: wrap;">
                    <a href="https://www.enable-javascript.com/ar/" 
                       target="_blank" 
                       rel="noopener noreferrer"
                       style="background: #1976d2; color: white; padding: 12px 24px; border-radius: 5px; text-decoration: none; font-weight: bold;">
                        كيفية تمكين JavaScript
                    </a>
                    <button onclick="location.reload()" 
                            style="background: #4caf50; color: white; padding: 12px 24px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">
                        إعادة تحميل الصفحة
                    </button>
                </div>
            </div>
        </div>
    </noscript>
    
    <!-- Root element where React app will be mounted -->
    <div id="root" role="main" id="main-content"></div>
    
    <!-- Service Worker Registration -->
    <script>
        // Remove loading screen and show app
        window.addEventListener('load', function() {
            setTimeout(function() {
                var loadingScreen = document.getElementById('loading-screen');
                var root = document.getElementById('root');
                
                if (loadingScreen) {
                    loadingScreen.style.opacity = '0';
                    setTimeout(function() {
                        loadingScreen.style.display = 'none';
                        root.classList.add('loaded');
                    }, 500);
                }
            }, 1000);
            
            // Register service worker for PWA
            if ('serviceWorker' in navigator && window.location.hostname !== 'localhost') {
                navigator.serviceWorker.register('%PUBLIC_URL%/service-worker.js')
                    .then(function(registration) {
                        console.log('Service Worker registered with scope:', registration.scope);
                    })
                    .catch(function(error) {
                        console.log('Service Worker registration failed:', error);
                    });
            }
            
            // Detect browser language
            var userLang = navigator.language || navigator.userLanguage;
            if (userLang.startsWith('ar')) {
                document.documentElement.lang = 'ar';
                document.documentElement.dir = 'rtl';
            }
        });
        
        // Error handling
        window.addEventListener('error', function(e) {
            console.error('Application error:', e.error);
            // You can send this to your error tracking service
        });
        
        // Offline detection
        window.addEventListener('offline', function() {
            if (document.getElementById('offline-alert')) return;
            
            var alert = document.createElement('div');
            alert.id = 'offline-alert';
            alert.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                left: 20px;
                background: #ff9800;
                color: white;
                padding: 15px;
                border-radius: 5px;
                text-align: center;
                z-index: 10000;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                animation: slideIn 0.3s ease-out;
            `;
            alert.innerHTML = `
                <strong>⚠️ أنت غير متصل بالإنترنت</strong>
                <p style="margin: 5px 0 0 0; font-size: 0.9em;">
                    بعض الميزات قد لا تعمل بشكل صحيح. يرجى التحقق من اتصالك بالإنترنت.
                </p>
            `;
            document.body.appendChild(alert);
            
            setTimeout(function() {
                alert.style.animation = 'slideOut 0.3s ease-out';
                setTimeout(function() {
                    if (alert.parentNode) {
                        alert.parentNode.removeChild(alert);
                    }
                }, 300);
            }, 5000);
        });
        
        window.addEventListener('online', function() {
            var alert = document.getElementById('offline-alert');
            if (alert) {
                alert.style.background = '#4caf50';
                alert.innerHTML = `
                    <strong>✅ تم استعادة الاتصال بالإنترنت</strong>
                    <p style="margin: 5px 0 0 0; font-size: 0.9em;">
                        جميع الميزات تعمل الآن بشكل طبيعي.
                    </p>
                `;
                
                setTimeout(function() {
                    if (alert.parentNode) {
                        alert.parentNode.removeChild(alert);
                    }
                }, 3000);
            }
        });
        
        // Add CSS for animations
        var style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from {
                    transform: translateY(-100%);
                    opacity: 0;
                }
                to {
                    transform: translateY(0);
                    opacity: 1;
                }
            }
            
            @keyframes slideOut {
                from {
                    transform: translateY(0);
                    opacity: 1;
                }
                to {
                    transform: translateY(-100%);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);
    </script>
    
    <!-- Legacy browser warning -->
    <script>
        // Check for modern browser features
        var isModernBrowser = 'fetch' in window && 
                              'Promise' in window && 
                              'Symbol' in window &&
                              'URL' in window &&
                              'IntersectionObserver' in window;
        
        if (!isModernBrowser) {
            var warning = document.createElement('div');
            warning.style.cssText = `
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                background: #ffeb3b;
                color: #333;
                padding: 10px 20px;
                text-align: center;
                border-top: 2px solid #ffc107;
                z-index: 9999;
                font-size: 14px;
            `;
            warning.innerHTML = `
                <strong>ملاحظة:</strong> 
                أنت تستخدم متصفح قديم. بعض الميزات قد لا تعمل بشكل صحيح. 
                ننصحك بالتحديث إلى أحدث نسخة من 
                <a href="https://www.google.com/chrome/" target="_blank" style="color: #1976d2; font-weight: bold;">Chrome</a> أو 
                <a href="https://www.mozilla.org/firefox/" target="_blank" style="color: #1976d2; font-weight: bold;">Firefox</a>.
                <button onclick="this.parentNode.style.display='none'" 
                        style="background: #f44336; color: white; border: none; padding: 2px 8px; margin-right: 10px; border-radius: 3px; cursor: pointer;">
                    ✕
                </button>
            `;
            document.body.appendChild(warning);
        }
    </script>
    
    <!-- Firebase Performance Monitoring (Optional) -->
    <!--
    <script>
        if ('perf' in window.firebase) {
            var perf = window.firebase.perf();
            // Performance monitoring is now enabled
        }
    </script>
    -->
</body>
</html>
